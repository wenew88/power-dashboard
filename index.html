<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Plant Dashboard</title>
    <style>
        body { font-family: Arial; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1400px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; }
        .section { margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; }
        label { display: inline-block; width: 200px; font-weight: bold; }
        input { padding: 5px; width: 150px; margin-bottom: 10px; }
        table { border-collapse: collapse; width: 100%; font-size: 12px; }
        th, td { border: 1px solid #ddd; padding: 4px; text-align: right; }
        .highlighted { background-color: #90EE90; }
        .results { font-weight: bold; margin: 15px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Variables</h2>
        <div class="section">
            <div>
                <label>Number of Engines:</label>
                <input type="number" id="engineCount" value="1" min="1">
            </div>
            <div>
                <label>Gas Engine (kWe):</label>
                <input type="number" id="gasEngine" value="315">
            </div>
            <div>
                <label>NG consumption (m³):</label>
                <input type="number" id="ngConsumption" value="84">
            </div>
            <div>
                <label>Load (%):</label>
                <input type="number" id="loadPercentage" value="0.9" step="0.1" max="1">
            </div>
            <div>
                <label>Gas price (per m³):</label>
                <input type="number" id="gasPrice" value="16.5">
            </div>
        </div>

        <h2>Results</h2>
        <div class="section">
            <div>
                <label>kWe:</label>
                <span id="kweResult">0</span>
            </div>
            <div>
                <label>Consumption:</label>
                <span id="consumptionResult">0</span>
            </div>
            <div>
                <label>1 kWe price:</label>
                <span id="kWePriceResult">0</span>
            </div>
            <div>
                <label>1 MWe price:</label>
                <span id="mWePriceResult">0</span>
            </div>
        </div>

        <h2>Monthly Spending</h2>
        <div class="section">
            <div>
                <label>Oil:</label>
                <input type="number" id="oilCost" value="32800">
            </div>
            <div>
                <label>Service and parts:</label>
                <input type="number" id="serviceCost" value="41000">
            </div>
            <div>
                <label>Workers (3):</label>
                <input type="number" id="workersCost" value="49200">
            </div>
            <div>
                <label>Salary taxes (22%):</label>
                <input type="number" id="taxCost" value="10824">
            </div>
            <div>
                <label>Other expenses:</label>
                <input type="number" id="otherCost" value="61500">
            </div>
            <div class="results">
                <label>Total Monthly Spending:</label>
                <span id="totalSpending">0</span>
            </div>
        </div>

        <h2>Price Analysis</h2>
        <div class="section">
            <div>
                <label>Minimum Price:</label>
                <input type="number" id="minPrice" value="5000" onchange="updateAnalysis()">
            </div>

            <div class="results">
                <div>Hours above minimum price: <span id="hourCount">0</span></div>
                <div>Total Income: <span id="totalIncome">0</span></div>
                <div>Annual Revenue (after expenses): <span id="totalRevenue">0</span></div>
            </div>

            <div id="priceTable" style="overflow-x: auto;">
                <!-- Table will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // Complete price data array from Excel
        const priceData = [[1,57,57,55.55,38,32,30,30,65,200,246,246,90,90,93,160,600,960,1210,999,720,470,140,68,70],[2,26,11,11,11,11,11.01,28,205,2700,3000,2489,2415,2415,2489,2862,2989,3200,3499,3286,3200,2750,2489,68,70],[3,26,20,10,10,10,10,1000,2540,3200,3600,3297,2989,2900,3111.66,3300,3400,3499,3600,3600,3499,3290,2900,2000,1600],[4,2090,1995,147,20,10,10,1995,2455,2090,2300,2079,2000,1880,2005,2300,2500,2537,2537,2537,2537,2300,1650,2090,2090],[5,2090,1600,200,200,100,20,1200,2400,2090,2100,1995,1995,1992,1995,2090,2900,3200,2989,2989,2989,2489,2090,2489,2489],[6,2489,500,63,10,10,10,10,99,99,739,990,739,680,1799,2090,2489,3000,3095,3000,2600,2090,1990,2090,1990],[7,2090,1100,300,87,200,200,200,34,1750,2550,2950,2989,2989,2989,2989,2989,3354,3650,3354,3350,3354,2554,2000,2060],[8,2599,2090,1600,1000,1200,2090,2734,3199,4500,6277.54,6520,5164,4948.83,4952.46,4950.04,4951.44,4953.47,6446.5,6417.62,5644,5700,4100,2700,2719],[9,2695,2500,2499,2090,2090,2500,2773.77,3354,4100,4100,3354,2998,2695,2700,3597,4950,5588,7214.22,6591,6529,7100,5900,3200,2988],[10,2735,2695,2695,2499,2650,2695,2900,3500,4950,6031.19,4950,4000,3700,4000,4950,5498.69,5600,7213.39,7000,6637,6837.64,6700,4950,3000],[11,2800,2825.45,2771.37,2755,2770.38,2826.63,3000,3597,5600,6667.31,6824.4,5600,5600,5600,5600,5600,5600,6700,6365.94,6127,6222.8,6688,7302.82,3000],[12,2923.15,2851,2800,2755,2755,2824.78,3000,4300,5600,4950,4200,3829,3500,3597,4700,5499.53,5600,7301.03,7243.43,7000,7297.27,7212.69,7198,3000],[13,2985,2710,2697.58,2699.43,2699.3,2697.38,2750,3100,4000,4950,4700,4098.71,3936,3600,4100.56,4103.2,4900,5600,5600,5300,5600,5150,4900,3000],[14,2720,2669.19,2627.85,2620,2620,2620,2620,2100,3290,3820,3900,3444,3310,3290,3354,3597,3988,4900,4950,4900,4950,4900,3977.49,3000],[15,2720,2499,2499,2499,2499,2619,2820.97,4588.75,6000,4980,4400,3800,3499,3400,3829,4526.09,4900,5100,5150,5029,5000,4671,4028,3000],[16,2699,2499,2499,2090,2499,2699,3000,4680,6000,6517,5677,5000,4200,4200,4488,5150,5509,6500,6400,6500,6400,6343.55,4472.04,3000],[17,2750,2699,2699,2699,2699,2750,3000,5383.67,6400,6074.56,4899,4200,3748,4044.66,4800,5600,5600,7500,7200,6651,6500,6204,4080,3000],[18,2090,1499,1349.5,998,998,1080,2499,3344,4500,6075.14,5806.41,4854.89,4646.98,4200,4500,4582,4853.21,5200,5200,4800,3790,4100,2999,2900],[19,2680,2680,2600,2499,2499,2680,2808.23,3300,4800,6451.78,6500,5023.45,5024.34,5023.16,5025.41,5025.27,5027.45,5800,4950,4590,4590,4200,3800,2923.38],[20,2664,2400,2090,2080,2080,2080,2090,2080,3408,3676,3690,3450,3050,3050,3190,3420,4184,5200,5200,4950,4590,4000,3500,2924.88],[21,2744,2680,2499,2090,2080,2011,2011,1999,2689,2937,2699,2688,2688,2680,2699,3000,4000,4500,4500,4150,4200,3595,3000,2850],[22,2720,2080,2080,1960,2080,2664,2917.44,3580,4500,4299,3499,2720,2720,2720,3280,3799,4484,5800,5150,4490,3720,3500,2720,2750],[23,2600,2090,2090,2000,2090,2400,2890,3941.64,4821.29,6200,4800,3500,3331,3495,3929,4200,5000,6300,6767.52,6100,5200,4205,3100,2823.51],[24,2499,2199,2199,2090,2090,2400,2919.42,4047,4678,5980,4300,3495,3215.97,3260,3260,3500,4500,6100,6100,4480,4500,3720,2720,2499],[25,2499,2199,2400,2078,2078,2499,2715,3800,4800,6848.7,6764.44,4300,3953.31,3500,3495,3787,3720,5800,5590.33,4500,3800,3500,2500,2499],[26,1499,2078,2078,1470,1560,2000,2600,3760,5014.46,6000,6000,4500,4177,3800,4000,4200,4300,5500,5200,5200,4395,3800,3200,2499],[27,2499,2600,2499,2499,2499,2311,2499,2695,3760,5100,5000,4406,4200,3943.23,4000,4120,4500,6300,5900,5522.19,5900,4500,4100,2840],[28,2499,2499,2499,2499,2400,1499,2078,1499,2600,3300,3300,2695,2582,2350,2600,3000,3658,4800,4950,4800,4433,4000,3200,2709],[29,2499,2090,2400,2088,2400,2499,2712,4184,4800,5891.56,4800,3492,2581.9,2695,3248,3690,4864.79,6100,6100,5800,4837,4428,3200,2712],[30,2599,2599,2599,2599,2599,2650,2890,4200,4800,4300,3679,3367,2695,2695,3248,3800,4800,7100,7100,6361,5800,5400,3800,2840],[31,2599,2249,2311,2249,2311,2599,2795,3500,3760,3950,3650,2600,2450,2450,3200,3450,4000,5907.37,5887,4800,4180,3995,3300,2712],[1,2599,2249,2599,2599,2599,2650,2795,3300,3395,2694,2249,2249,2248,2248,2650,2720,3500,4500,4500,3948,3488,3399,2988,2712],[2,2245,2090,2244,2090,2244,2244,2599,3755,4635,4754,3330,2750,2219,2219,2690,3200,3490,5150,5200,4600,4600,4100,3330,2245],[3,2599,2090,2245,1400,1850,888,1999.3,3000,3700,4072,4600,3447,3447,3400,3330,3448,3295,5200,5200,5200,4550,4100,3289,2245],[4,900,2000,2000,1260,1305,500,688,1450,2988,2854,3099,2245,2090,2245,2780,2245,2500,4300,4500,4494,3720,3440,2415,1000],[5,200,388,589,497,500,500,2230,2600,3700,4500,4283.28,3330,2950,2780,2800,3262,3100,4800,5000,4700,4600,4244,3330,998],[6,2599,2599,2599,2599,2599,2599,2795